<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foom.ist - When Silicon Surpasses Human Brainpower</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Watch in real-time as global chip production races to exceed the cumulative processing power of all human brains. An interactive visualization of the coming intelligence explosion.">
    <meta name="keywords" content="AI, artificial intelligence, singularity, MIPS, FLOPS, Moore's Law, brain computing, chip production, foom, intelligence explosion">
    <meta name="author" content="foom.ist">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://foom.ist/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://foom.ist/">
    <meta property="og:title" content="Foom.ist - When Silicon Surpasses Human Brainpower">
    <meta property="og:description" content="Watch in real-time as global chip production races to exceed the cumulative processing power of all human brains.">
    <meta property="og:image" content="https://foom.ist/og.jpg">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Visualization showing chip FLOPS vs human brain processing power over time">
    <meta property="og:site_name" content="Foom.ist">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:domain" content="foom.ist">
    <meta name="twitter:url" content="https://foom.ist/">
    <meta name="twitter:title" content="Foom.ist - When Silicon Surpasses Human Brainpower">
    <meta name="twitter:description" content="Watch in real-time as global chip production races to exceed the cumulative processing power of all human brains.">
    <meta name="twitter:image" content="https://foom.ist/og.jpg">
    <meta name="twitter:image:alt" content="Visualization showing chip FLOPS vs human brain processing power over time">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ§ </text></svg>">

    <!-- Theme Color -->
    <meta name="theme-color" content="#0a0a0f">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Foom.ist",
        "description": "Interactive visualization of when global chip production will exceed human brain processing power",
        "url": "https://foom.ist",
        "applicationCategory": "Visualization",
        "operatingSystem": "Web Browser",
        "author": {
            "@type": "Organization",
            "name": "Foom.ist"
        }
    }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a2e;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent-human: #ff6b6b;
            --accent-chip: #4ecdc4;
            --accent-crossover: #ffd93d;
            --border-color: #2a2a3e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-human), var(--accent-chip));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .header-cta {
            margin-top: 1.5rem;
        }

        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent-chip), var(--accent-human));
            color: var(--bg-primary);
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.4);
        }

        .share-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 0.8rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.75rem;
            transition: all 0.2s;
            cursor: pointer;
        }

        .share-btn:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .share-btn.twitter:hover { border-color: #1da1f2; color: #1da1f2; }
        .share-btn.facebook:hover { border-color: #4267b2; color: #4267b2; }
        .share-btn.linkedin:hover { border-color: #0077b5; color: #0077b5; }
        .share-btn.copy:hover { border-color: var(--accent-chip); color: var(--accent-chip); }

        .share-btn svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .counters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .counter-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .counter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }

        .counter-card.human::before {
            background: var(--accent-human);
        }

        .counter-card.chip::before {
            background: var(--accent-chip);
        }

        .counter-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .counter-value {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            font-weight: bold;
            font-family: 'SF Mono', monospace;
            margin-bottom: 0.5rem;
        }

        .counter-card.human .counter-value {
            color: var(--accent-human);
        }

        .counter-card.chip .counter-value {
            color: var(--accent-chip);
        }

        .counter-rate {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .crossover-banner {
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            border: 2px solid var(--accent-crossover);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
        }

        .crossover-title {
            color: var(--accent-crossover);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .crossover-date {
            font-size: clamp(1.5rem, 4vw, 2rem);
            font-weight: bold;
            color: var(--text-primary);
        }

        .crossover-status {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .chart-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .controls {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .controls h2 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .control-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .control-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .control-btn:hover {
            background: var(--border-color);
        }

        .control-btn.active {
            background: var(--accent-chip);
            color: var(--bg-primary);
            border-color: var(--accent-chip);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-chip);
            border-radius: 50%;
            cursor: pointer;
        }

        .slider-value {
            min-width: 60px;
            text-align: right;
            font-size: 0.85rem;
            color: var(--accent-chip);
        }

        .reset-btn {
            padding: 0.3rem 0.6rem;
            font-size: 0.7rem;
            margin-left: 0.5rem;
        }

        .reset-btn:hover {
            background: var(--accent-human);
            border-color: var(--accent-human);
            color: var(--bg-primary);
        }

        .data-status {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .data-status.live {
            border-left: 3px solid var(--accent-chip);
        }

        .data-status.cached {
            border-left: 3px solid var(--accent-crossover);
        }

        /* Suggestion Form Styles */
        .suggest-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .suggest-section h2 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .suggest-intro {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .suggest-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .form-group label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.6rem 0.8rem;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.85rem;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-chip);
        }

        .form-group input::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        .form-hint {
            font-size: 0.7rem;
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .submit-btn {
            background: var(--accent-chip);
            border: none;
            color: var(--bg-primary);
            padding: 0.8rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.2s;
            align-self: flex-start;
        }

        .submit-btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .form-status {
            font-size: 0.85rem;
            padding: 0.5rem;
            border-radius: 4px;
            display: none;
        }

        .form-status.success {
            display: block;
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid var(--accent-chip);
            color: var(--accent-chip);
        }

        .form-status.error {
            display: block;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid var(--accent-human);
            color: var(--accent-human);
        }

        .suggest-note {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 1rem;
            opacity: 0.8;
        }

        .suggest-note a {
            color: var(--accent-chip);
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .sources {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .sources h2 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .source-section {
            margin-bottom: 1.5rem;
        }

        .source-section:last-child {
            margin-bottom: 0;
        }

        .source-title {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .source-list {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .source-list a {
            color: var(--accent-chip);
            text-decoration: none;
        }

        .source-list a:hover {
            text-decoration: underline;
        }

        .assumption-box {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 0.5rem;
            font-size: 0.75rem;
        }

        .assumption-box code {
            color: var(--accent-crossover);
            background: var(--bg-primary);
            padding: 0.1rem 0.3rem;
            border-radius: 3px;
        }

        footer {
            text-align: center;
            padding: 2rem 0;
            color: var(--text-secondary);
            font-size: 0.75rem;
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
        }

        footer a {
            color: var(--accent-chip);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .indicator.human {
            background: var(--accent-human);
        }

        .indicator.chip {
            background: var(--accent-chip);
        }

        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            .chart-wrapper {
                height: 300px;
            }

            .control-btn {
                flex: 1;
                min-width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>The Flippening is Coming</h1>
            <p class="subtitle">When cumulative chip FLOPS exceeds all human brainpower born since 1970</p>
            <div class="header-cta">
                <a href="#suggest-section" class="cta-button">Have better data? Help improve this</a>
            </div>
            <div class="share-buttons">
                <a href="https://x.com/intent/tweet?url=https://foom.ist&text=When%20will%20global%20chip%20production%20exceed%20human%20brainpower%3F%20Watch%20it%20happen%20in%20real-time." target="_blank" rel="noopener" class="share-btn twitter">
                    <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                    Share
                </a>
                <a href="https://www.facebook.com/sharer/sharer.php?u=https://foom.ist" target="_blank" rel="noopener" class="share-btn facebook">
                    <svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                    Share
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://foom.ist" target="_blank" rel="noopener" class="share-btn linkedin">
                    <svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                    Share
                </a>
                <button onclick="copyLink()" class="share-btn copy">
                    <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    <span id="copy-text">Copy Link</span>
                </button>
            </div>
        </header>

        <div class="counters">
            <div class="counter-card human">
                <div class="counter-label">
                    <span class="indicator human pulse"></span>
                    Cumulative Human Brain ops/s (since 1970)
                </div>
                <div class="counter-value" id="human-mips">0</div>
                <div class="counter-rate" id="human-rate">Loading...</div>
            </div>
            <div class="counter-card chip">
                <div class="counter-label">
                    <span class="indicator chip pulse"></span>
                    Cumulative Chip FLOPS (since 1970)
                </div>
                <div class="counter-value" id="chip-mips">0</div>
                <div class="counter-rate" id="chip-rate">Loading...</div>
            </div>
        </div>

        <div class="crossover-banner">
            <div class="crossover-title">ESTIMATED CROSSOVER DATE</div>
            <div class="crossover-date" id="crossover-date">Calculating...</div>
            <div class="crossover-status" id="crossover-status"></div>
        </div>

        <div class="chart-container">
            <div class="chart-wrapper">
                <canvas id="mips-chart"></canvas>
            </div>
        </div>

        <div class="controls">
            <h2>ADJUST ASSUMPTIONS</h2>

            <div class="control-group">
                <label class="control-label">Human Brain Processing Power Estimate</label>
                <div class="control-row">
                    <button class="control-btn" data-brain="conservative" title="Moravec's estimate based on retinal processing">
                        Conservative (10^14 ops/s)
                    </button>
                    <button class="control-btn active" data-brain="moderate" title="Mid-range estimate from synapse operations">
                        Moderate (10^16 ops/s)
                    </button>
                    <button class="control-btn" data-brain="aggressive" title="High estimate including all neural activity">
                        Aggressive (10^18 ops/s)
                    </button>
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">Moore's Law Equivalent Growth Rate (% per year)</label>
                <div class="slider-container">
                    <input type="range" class="slider" id="moore-slider" min="20" max="60" value="35">
                    <span class="slider-value" id="moore-value">35%</span>
                    <button class="control-btn reset-btn" id="moore-reset" title="Reset to default (35%)">Reset</button>
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">Birth Rate Trend</label>
                <div class="control-row">
                    <button class="control-btn" data-birth="declining" title="UN projection: births declining ~0.5%/year">
                        Declining (-0.5%/yr)
                    </button>
                    <button class="control-btn active" data-birth="stable" title="Births remain stable at ~130M/year">
                        Stable (~130M/yr)
                    </button>
                    <button class="control-btn" data-birth="recovering" title="Hypothetical recovery scenario">
                        Recovering (+0.3%/yr)
                    </button>
                </div>
            </div>
        </div>

        <div class="sources">
            <h2>DATA SOURCES & ASSUMPTIONS</h2>

            <div class="source-section">
                <div class="source-title">Birth Rate Data</div>
                <div class="source-list">
                    <a href="https://ourworldindata.org/grapher/crude-birth-rate" target="_blank">Our World in Data - Birth Rate</a> |
                    <a href="https://www.un.org/development/desa/pd/" target="_blank">UN World Fertility Report 2024</a> |
                    <a href="https://statisticstimes.com/demographics/world-death-and-birth-rate.php" target="_blank">StatisticsTimes</a>
                </div>
                <div class="assumption-box">
                    Current: <code>~132.4M births/year</code> (2025) = <code>~4.2 births/second</code><br>
                    Historical peak: 146M births in 2012. Projected stable at 130-140M through 2050s.
                </div>
            </div>

            <div class="source-section">
                <div class="source-title">Human Brain Processing Estimates</div>
                <div class="source-list">
                    <a href="https://jetpress.org/volume1/moravec.htm" target="_blank">Moravec (1998)</a> |
                    <a href="https://aiimpacts.org/brain-performance-in-flops/" target="_blank">AI Impacts - Brain FLOPS</a> |
                    <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7660359/" target="_blank">Sandberg & Bostrom</a>
                </div>
                <div class="assumption-box">
                    <strong>Conservative:</strong> <code>10^14 ops/s</code> - Moravec's retinal processing extrapolation<br>
                    <strong>Moderate:</strong> <code>10^16 ops/s</code> - Synapse count Ã— firing rate estimate<br>
                    <strong>Aggressive:</strong> <code>10^18 ops/s</code> - Full neural complexity estimate<br>
                    Note: MIPS â‰ˆ operations/second for comparison purposes. Actual brain computation is non-comparable.
                </div>
            </div>

            <div class="source-section">
                <div class="source-title">Chip Production Data</div>
                <div class="source-list">
                    <a href="https://investor.nvidia.com/financial-info/sec-filings/default.aspx" target="_blank">NVIDIA SEC 10-K Filings</a> |
                    <a href="https://epoch.ai/data/machine-learning-hardware" target="_blank">Epoch AI - ML Hardware Dataset</a> |
                    <a href="https://www.wsts.org/" target="_blank">WSTS - World Semiconductor Trade Statistics</a> |
                    <a href="https://www.semiconductors.org/data-resources/market-data/" target="_blank">SIA Market Data</a>
                </div>
                <div class="assumption-box">
                    <strong>2007:</strong> <code>2Ã—10^20 IPS</code> global capacity (Hilbert & Lopez, 2012)<br>
                    <strong>2021:</strong> <code>1.15T</code> semiconductor units shipped (WSTS)<br>
                    <strong>2023:</strong> NVIDIA shipped ~550K H100s @ 4 petaFLOPS = <code>2.2Ã—10^21</code> FLOPS<br>
                    <strong>2024:</strong> NVIDIA ~2M H100-equiv, $130B data center revenue (SEC 10-K)<br>
                    <strong>2025:</strong> Epoch AI projects 6.5-7M AI GPUs; installed base ~4M H100-equiv<br>
                    Hardware FLOPS/$ doubles every ~2.5 years (Epoch AI GPU dataset)
                </div>
            </div>

            <div class="source-section">
                <div class="source-title">Inspiration</div>
                <div class="source-list">
                    Charles Stross, <em>Accelerando</em> (2005): "Sometime in this century laboring women will produce
                    forty-five thousand babies a day, representing 10^23 MIPS of processing power. Also around the world,
                    fab lines will churn out thirty million microprocessors a day, representing 10^23 MIPS of processing power."
                </div>
            </div>
        </div>

        <!-- Suggestion Form -->
        <div class="suggest-section" id="suggest-section">
            <h2>SUGGEST BETTER DATA</h2>
            <p class="suggest-intro">Found a more accurate or recent source? Help improve this visualization.</p>

            <form id="suggest-form" class="suggest-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="data-type">Data Category</label>
                        <select id="data-type" name="dataType" required>
                            <option value="">Select...</option>
                            <option value="births">Birth Rate Data</option>
                            <option value="brain">Brain Processing Estimates</option>
                            <option value="chips">Chip Production Data</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="data-year">Year (if applicable)</label>
                        <input type="number" id="data-year" name="year" min="1970" max="2030" placeholder="e.g., 2024">
                    </div>
                </div>

                <div class="form-group">
                    <label for="source-url">Source URL</label>
                    <input type="url" id="source-url" name="sourceUrl" required
                           placeholder="https://example.gov/report.pdf"
                           pattern="https://.*">
                    <span class="form-hint">Must be HTTPS. Preferred: .gov, .edu, .org, arxiv.org, SEC.gov</span>
                </div>

                <div class="form-group">
                    <label for="data-value">Claimed Value</label>
                    <input type="text" id="data-value" name="value" required
                           placeholder="e.g., 135.2 million births in 2024"
                           maxlength="200">
                </div>

                <div class="form-group">
                    <label for="source-name">Source Name</label>
                    <input type="text" id="source-name" name="sourceName" required
                           placeholder="e.g., UN World Population Prospects 2024"
                           maxlength="100">
                </div>

                <button type="submit" class="submit-btn" id="submit-btn">
                    Submit Suggestion
                </button>
                <div id="form-status" class="form-status"></div>
            </form>

            <p class="suggest-note">
                Suggestions are reviewed by an AI system that verifies the source and updates the site automatically if valid.
                <a href="https://github.com/StefanSamne/foomist/issues" target="_blank">View pending suggestions</a>
            </p>
        </div>

        <footer>
            <p>Inspired by Charles Stross's <em>Accelerando</em> |
            <a href="https://github.com/StefanSamne/foomist" target="_blank">View Source</a> |
            Data updated January 2026</p>
            <p style="margin-top: 0.5rem;">
                Note: This is a thought experiment. Brain processing and chip MIPS are fundamentally different
                and not directly comparable. The crossover is symbolic, not literal.
            </p>
        </footer>
    </div>

    <script>
        // ============================================
        // CONFIGURATION & CONSTANTS
        // ============================================

        const DEFAULTS = {
            mooresLawRate: 0.35  // 35% annual growth - can be reset to this
        };

        const CONFIG = {
            // Brain processing estimates (operations per second)
            brainEstimates: {
                conservative: 1e14,  // 10^14 ops/s - Moravec
                moderate: 1e16,      // 10^16 ops/s - Synapse-based
                aggressive: 1e18    // 10^18 ops/s - High estimate
            },

            // Birth rate scenarios (births per year, with annual change rate)
            birthScenarios: {
                declining: { base2025: 132.4e6, annualChange: -0.005 },
                stable: { base2025: 132.4e6, annualChange: 0 },
                recovering: { base2025: 132.4e6, annualChange: 0.003 }
            },

            // Historical birth data (millions per year)
            historicalBirths: {
                1970: 121, 1975: 124, 1980: 129, 1985: 137, 1990: 143,
                1995: 134, 2000: 130, 2005: 134, 2010: 140, 2012: 146,
                2015: 142, 2020: 140, 2025: 132
            },

            // Chip FLOPS history (estimated total FLOPS shipped that year)
            // Sources: Hilbert & Lopez (2012), Epoch AI, NVIDIA SEC 10-K, WSTS, SIA
            // Note: Using FLOPS as proxy for "operations" - more accurate than MIPS for modern chips
            historicalChipFLOPS: {
                1971: 1e3,           // Intel 4004: 0.09 MIPS, ~2,300 chips sold
                1975: 1e6,           // 8080 era, early hobbyist computers
                1980: 1e9,           // 8086/Z80, ~10M microprocessors
                1985: 1e11,          // 80286/386, PC boom begins
                1990: 1e13,          // 486 era, ~50M PCs sold/year
                1995: 5e14,          // Pentium era, ~100M PCs/year
                2000: 1e16,          // GHz race, ~150M PCs/year
                2005: 5e17,          // Multi-core, mobile begins
                2007: 2e20,          // Hilbert & Lopez measured: 2Ã—10^20 IPS global capacity
                2010: 1e21,          // Smartphone explosion, 1.5B chips/year
                2015: 5e21,          // Epoch AI: ~10^21-10^22 range
                2018: 1e22,          // 23.3B microprocessor units shipped (Statista)
                2020: 2e22,          // COVID chip demand surge
                2021: 4e22,          // 1.15T semiconductor units shipped (WSTS)
                2023: 8e22,          // NVIDIA: 550K H100s @ 4 petaFLOPS each = 2.2e21 just from H100
                2024: 2e23,          // NVIDIA: ~2M H100s + Blackwell ramp, total AI chips ~4M H100-equiv
                2025: 4e23           // Epoch AI projects 6.5-7M AI GPUs, plus consumer/mobile
            },

            startYear: 1970,
            endYear: 2070,
            baseYear: 2025
        };

        // ============================================
        // STATE
        // ============================================

        let state = {
            brainEstimate: 'moderate',
            birthScenario: 'stable',
            mooresLawRate: 0.35,  // 35% annual growth
            chart: null
        };

        // ============================================
        // CALCULATIONS
        // ============================================

        function getBirthsForYear(year) {
            if (year <= 2025) {
                // Use historical data with interpolation
                const years = Object.keys(CONFIG.historicalBirths).map(Number).sort((a, b) => a - b);
                for (let i = 0; i < years.length - 1; i++) {
                    if (year >= years[i] && year <= years[i + 1]) {
                        const t = (year - years[i]) / (years[i + 1] - years[i]);
                        return CONFIG.historicalBirths[years[i]] * (1 - t) +
                               CONFIG.historicalBirths[years[i + 1]] * t;
                    }
                }
                return CONFIG.historicalBirths[years[years.length - 1]];
            } else {
                // Project future based on scenario
                const scenario = CONFIG.birthScenarios[state.birthScenario];
                const yearsFromBase = year - 2025;
                return scenario.base2025 * Math.pow(1 + scenario.annualChange, yearsFromBase) / 1e6;
            }
        }

        function getChipFLOPSForYear(year) {
            if (year <= 2025) {
                // Use historical data with interpolation
                const years = Object.keys(CONFIG.historicalChipFLOPS).map(Number).sort((a, b) => a - b);

                if (year < years[0]) return 0;

                for (let i = 0; i < years.length - 1; i++) {
                    if (year >= years[i] && year <= years[i + 1]) {
                        // Exponential interpolation
                        const t = (year - years[i]) / (years[i + 1] - years[i]);
                        const logStart = Math.log10(CONFIG.historicalChipFLOPS[years[i]]);
                        const logEnd = Math.log10(CONFIG.historicalChipFLOPS[years[i + 1]]);
                        return Math.pow(10, logStart + t * (logEnd - logStart));
                    }
                }
                return CONFIG.historicalChipFLOPS[years[years.length - 1]];
            } else {
                // Project future with Moore's Law rate
                const base = CONFIG.historicalChipFLOPS[2025];
                const yearsFromBase = year - 2025;
                return base * Math.pow(1 + state.mooresLawRate, yearsFromBase);
            }
        }

        function getCumulativeOps(year, type) {
            let cumulative = 0;
            const brainOps = CONFIG.brainEstimates[state.brainEstimate];

            for (let y = CONFIG.startYear; y <= year; y++) {
                if (type === 'human') {
                    // Births in millions Ã— brain ops per brain
                    const birthsMillions = getBirthsForYear(y);
                    cumulative += birthsMillions * 1e6 * brainOps;
                } else {
                    cumulative += getChipFLOPSForYear(y);
                }
            }
            return cumulative;
        }

        function findCrossoverYear() {
            for (let year = CONFIG.startYear; year <= CONFIG.endYear; year += 0.1) {
                const humanMIPS = getCumulativeOps(year, 'human');
                const chipMIPS = getCumulativeOps(year, 'chip');

                if (chipMIPS >= humanMIPS) {
                    return year;
                }
            }
            return null;  // No crossover in range
        }

        function formatMIPS(value) {
            if (value === 0) return '0';

            const exponent = Math.floor(Math.log10(value));
            const mantissa = value / Math.pow(10, exponent);

            if (exponent < 6) {
                return value.toLocaleString();
            } else if (exponent < 9) {
                return (value / 1e6).toFixed(2) + ' million';
            } else if (exponent < 12) {
                return (value / 1e9).toFixed(2) + ' billion';
            } else if (exponent < 15) {
                return (value / 1e12).toFixed(2) + ' trillion';
            } else {
                return mantissa.toFixed(2) + ' Ã— 10^' + exponent;
            }
        }

        function formatScientific(value) {
            if (value === 0) return '0';
            const exponent = Math.floor(Math.log10(value));
            const mantissa = value / Math.pow(10, exponent);
            return mantissa.toFixed(2) + ' Ã— 10^' + exponent;
        }

        // ============================================
        // CHART
        // ============================================

        function generateChartData() {
            const years = [];
            const humanData = [];
            const chipData = [];

            for (let year = CONFIG.startYear; year <= CONFIG.endYear; year += 1) {
                years.push(year);
                humanData.push(getCumulativeOps(year, 'human'));
                chipData.push(getCumulativeOps(year, 'chip'));
            }

            return { years, humanData, chipData };
        }

        function createChart() {
            const ctx = document.getElementById('mips-chart').getContext('2d');
            const data = generateChartData();
            const crossoverYear = findCrossoverYear();

            // Find crossover index for annotation
            const crossoverIndex = crossoverYear ? Math.floor(crossoverYear - CONFIG.startYear) : null;

            state.chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.years,
                    datasets: [
                        {
                            label: 'Cumulative Human Brain ops/s',
                            data: data.humanData,
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 2
                        },
                        {
                            label: 'Cumulative Chip FLOPS',
                            data: data.chipData,
                            borderColor: '#4ecdc4',
                            backgroundColor: 'rgba(78, 205, 196, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#a0a0a0',
                                maxTicksLimit: 10
                            }
                        },
                        y: {
                            type: 'logarithmic',
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#a0a0a0',
                                callback: function(value) {
                                    const exp = Math.log10(value);
                                    if (Number.isInteger(exp) && exp % 5 === 0) {
                                        return '10^' + exp;
                                    }
                                    return '';
                                }
                            },
                            title: {
                                display: true,
                                text: 'Cumulative ops/s (log scale)',
                                color: '#a0a0a0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e0e0e0',
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 46, 0.95)',
                            titleColor: '#e0e0e0',
                            bodyColor: '#a0a0a0',
                            borderColor: '#2a2a3e',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatScientific(context.raw);
                                }
                            }
                        },
                        annotation: crossoverYear ? {
                            annotations: {
                                crossoverLine: {
                                    type: 'line',
                                    xMin: Math.round(crossoverYear),
                                    xMax: Math.round(crossoverYear),
                                    borderColor: '#ffd93d',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: {
                                        display: true,
                                        content: 'Crossover: ' + Math.round(crossoverYear),
                                        position: 'start',
                                        backgroundColor: 'rgba(255, 217, 61, 0.8)',
                                        color: '#0a0a0f',
                                        font: { weight: 'bold' }
                                    }
                                },
                                nowLine: {
                                    type: 'line',
                                    xMin: new Date().getFullYear(),
                                    xMax: new Date().getFullYear(),
                                    borderColor: 'rgba(255, 255, 255, 0.3)',
                                    borderWidth: 1,
                                    borderDash: [3, 3],
                                    label: {
                                        display: true,
                                        content: 'Now',
                                        position: 'end',
                                        backgroundColor: 'rgba(255, 255, 255, 0.2)',
                                        color: '#a0a0a0',
                                        font: { size: 10 }
                                    }
                                }
                            }
                        } : {
                            annotations: {
                                nowLine: {
                                    type: 'line',
                                    xMin: new Date().getFullYear(),
                                    xMax: new Date().getFullYear(),
                                    borderColor: 'rgba(255, 255, 255, 0.3)',
                                    borderWidth: 1,
                                    borderDash: [3, 3],
                                    label: {
                                        display: true,
                                        content: 'Now',
                                        position: 'end',
                                        backgroundColor: 'rgba(255, 255, 255, 0.2)',
                                        color: '#a0a0a0',
                                        font: { size: 10 }
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateChart() {
            if (!state.chart) return;

            // Destroy and recreate to update annotations
            state.chart.destroy();
            createChart();
        }

        // ============================================
        // COUNTERS
        // ============================================

        // Real-time counter state
        let counterState = {
            humanOps: 0,
            chipOps: 0,
            humanRate: 0,
            chipRate: 0,
            lastUpdate: Date.now(),
            initialized: false
        };

        function initializeCounters() {
            const now = new Date();
            const currentYear = now.getFullYear() + (now.getMonth() / 12) + (now.getDate() / 365);

            counterState.humanOps = getCumulativeOps(currentYear, 'human');
            counterState.chipOps = getCumulativeOps(currentYear, 'chip');

            // Calculate rates (ops per millisecond for smooth animation)
            const brainOps = CONFIG.brainEstimates[state.brainEstimate];
            const birthsPerSecond = getBirthsForYear(Math.floor(currentYear)) * 1e6 / (365.25 * 24 * 3600);
            counterState.humanRate = birthsPerSecond * brainOps / 1000;  // per ms

            const chipFLOPSThisYear = getChipFLOPSForYear(Math.floor(currentYear));
            counterState.chipRate = chipFLOPSThisYear / (365.25 * 24 * 3600 * 1000);  // per ms

            counterState.lastUpdate = Date.now();
            counterState.initialized = true;
        }

        function updateCounters() {
            if (!counterState.initialized) {
                initializeCounters();
            }

            const now = Date.now();
            const elapsed = now - counterState.lastUpdate;
            counterState.lastUpdate = now;

            // Increment based on elapsed time
            counterState.humanOps += counterState.humanRate * elapsed;
            counterState.chipOps += counterState.chipRate * elapsed;

            // Update display
            document.getElementById('human-mips').textContent = formatScientific(counterState.humanOps) + ' ops';
            document.getElementById('chip-mips').textContent = formatScientific(counterState.chipOps) + ' ops';

            // Calculate human-readable rates
            const brainOps = CONFIG.brainEstimates[state.brainEstimate];
            const currentYear = new Date().getFullYear();
            const birthsPerSecond = getBirthsForYear(currentYear) * 1e6 / (365.25 * 24 * 3600);

            document.getElementById('human-rate').textContent =
                '+' + formatScientific(counterState.humanRate * 1000) + ' ops/sec (' + birthsPerSecond.toFixed(1) + ' births/sec)';
            document.getElementById('chip-rate').textContent =
                '+' + formatScientific(counterState.chipRate * 1000) + ' ops/sec (continuous production)';
        }

        function resetCounters() {
            counterState.initialized = false;
            initializeCounters();
        }

        function updateCrossover() {
            const crossoverYear = findCrossoverYear();
            const crossoverDateEl = document.getElementById('crossover-date');
            const crossoverStatusEl = document.getElementById('crossover-status');

            if (crossoverYear === null) {
                crossoverDateEl.textContent = 'Beyond 2070';
                crossoverStatusEl.textContent = 'With current assumptions, crossover is not reached by 2070';
            } else if (crossoverYear <= new Date().getFullYear()) {
                crossoverDateEl.textContent = Math.round(crossoverYear);
                crossoverStatusEl.textContent = 'CROSSOVER ALREADY OCCURRED - Chip FLOPS exceeded human brain ops/s';
            } else {
                const yearsUntil = crossoverYear - new Date().getFullYear();
                crossoverDateEl.textContent = Math.round(crossoverYear);
                crossoverStatusEl.textContent =
                    `~${Math.round(yearsUntil)} years from now (with current growth assumptions)`;
            }
        }

        // ============================================
        // CONTROLS
        // ============================================

        function setupControls() {
            // Brain estimate buttons
            document.querySelectorAll('[data-brain]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('[data-brain]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    state.brainEstimate = btn.dataset.brain;
                    updateAll();
                });
            });

            // Birth scenario buttons
            document.querySelectorAll('[data-birth]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('[data-birth]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    state.birthScenario = btn.dataset.birth;
                    updateAll();
                });
            });

            // Moore's Law slider
            const slider = document.getElementById('moore-slider');
            const sliderValue = document.getElementById('moore-value');
            slider.addEventListener('input', () => {
                state.mooresLawRate = slider.value / 100;
                sliderValue.textContent = slider.value + '%';
                updateAll();
            });

            // Reset button for Moore's Law slider
            const resetBtn = document.getElementById('moore-reset');
            resetBtn.addEventListener('click', () => {
                const defaultValue = 35;
                state.mooresLawRate = defaultValue / 100;
                slider.value = defaultValue;
                sliderValue.textContent = defaultValue + '%';
                updateAll();
            });
        }

        function updateAll() {
            resetCounters();  // Reset counters when assumptions change
            updateChart();
            updateCounters();
            updateCrossover();
            updateURL();
        }

        // ============================================
        // URL SHARING
        // ============================================

        function updateURL() {
            const params = new URLSearchParams();
            params.set('brain', state.brainEstimate);
            params.set('birth', state.birthScenario);
            params.set('moore', Math.round(state.mooresLawRate * 100));

            const newURL = window.location.pathname + '?' + params.toString();
            history.replaceState(null, '', newURL);
        }

        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);

            if (params.has('brain') && CONFIG.brainEstimates[params.get('brain')]) {
                state.brainEstimate = params.get('brain');
                document.querySelectorAll('[data-brain]').forEach(b => {
                    b.classList.toggle('active', b.dataset.brain === state.brainEstimate);
                });
            }

            if (params.has('birth') && CONFIG.birthScenarios[params.get('birth')]) {
                state.birthScenario = params.get('birth');
                document.querySelectorAll('[data-birth]').forEach(b => {
                    b.classList.toggle('active', b.dataset.birth === state.birthScenario);
                });
            }

            if (params.has('moore')) {
                const moore = parseInt(params.get('moore'));
                if (moore >= 20 && moore <= 60) {
                    state.mooresLawRate = moore / 100;
                    document.getElementById('moore-slider').value = moore;
                    document.getElementById('moore-value').textContent = moore + '%';
                }
            }
        }

        // ============================================
        // SUGGESTION FORM HANDLING
        // ============================================

        const ALLOWED_DOMAINS = [
            'gov', 'edu', 'org', 'int',  // TLDs
            'arxiv.org', 'nature.com', 'science.org', 'sciencedirect.com',
            'springer.com', 'wiley.com', 'pnas.org', 'cell.com',
            'sec.gov', 'census.gov', 'bls.gov', 'un.org', 'worldbank.org',
            'imf.org', 'oecd.org', 'who.int', 'wsts.org',
            'nvidia.com', 'investor.nvidia.com', 'intel.com', 'amd.com',
            'tsmc.com', 'semiconductors.org', 'semi.org',
            'epoch.ai', 'aiimpacts.org', 'ourworldindata.org',
            'statista.com', 'macrotrends.net', 'tradingeconomics.com'
        ];

        function isAllowedDomain(url) {
            try {
                const hostname = new URL(url).hostname.toLowerCase();
                return ALLOWED_DOMAINS.some(domain => {
                    if (domain.includes('.')) {
                        // Full domain match
                        return hostname === domain || hostname.endsWith('.' + domain);
                    } else {
                        // TLD match
                        return hostname.endsWith('.' + domain);
                    }
                });
            } catch {
                return false;
            }
        }

        function sanitizeInput(str, maxLength = 200) {
            if (!str) return '';
            return str
                .replace(/<[^>]*>/g, '')  // Strip HTML tags
                .replace(/[<>"'`]/g, '')   // Remove dangerous chars
                .trim()
                .slice(0, maxLength);
        }

        function setupSuggestionForm() {
            const form = document.getElementById('suggest-form');
            const statusEl = document.getElementById('form-status');
            const submitBtn = document.getElementById('submit-btn');

            // API endpoint - replace with your Lambda URL after deployment
            const API_ENDPOINT = 'https://tnu93m4j91.execute-api.ca-central-1.amazonaws.com/suggest';

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                statusEl.className = 'form-status';
                statusEl.textContent = '';

                const formData = new FormData(form);
                const sourceUrl = formData.get('sourceUrl');

                // Client-side validation
                if (!sourceUrl.startsWith('https://')) {
                    statusEl.className = 'form-status error';
                    statusEl.textContent = 'URL must use HTTPS';
                    return;
                }

                if (!isAllowedDomain(sourceUrl)) {
                    statusEl.className = 'form-status error';
                    statusEl.textContent = 'Please use a trusted source (.gov, .edu, .org, academic publishers, or official company sites)';
                    return;
                }

                // Prepare sanitized payload
                const payload = {
                    dataType: sanitizeInput(formData.get('dataType'), 20),
                    year: parseInt(formData.get('year')) || null,
                    sourceUrl: sourceUrl,  // Already validated
                    value: sanitizeInput(formData.get('value'), 200),
                    sourceName: sanitizeInput(formData.get('sourceName'), 100),
                    timestamp: new Date().toISOString()
                };

                submitBtn.disabled = true;
                submitBtn.textContent = 'Submitting...';

                try {
                    const response = await fetch(API_ENDPOINT, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        statusEl.className = 'form-status success';
                        statusEl.textContent = `Suggestion submitted! Issue #${result.issueNumber} created for review.`;
                        form.reset();
                    } else {
                        throw new Error('Submission failed');
                    }
                } catch (err) {
                    statusEl.className = 'form-status error';
                    statusEl.textContent = 'Submission failed. Please try again or open an issue directly on GitHub.';
                    console.error('Suggestion submission error:', err);
                }

                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Suggestion';
            });
        }

        // ============================================
        // LIVE DATA APIs (optional enhancement)
        // ============================================

        // Attempt to fetch live data from APIs
        // Falls back gracefully to cached data if unavailable
        async function fetchLiveData() {
            const status = { population: 'cached', chips: 'cached' };

            // Try fetching world population data from API Ninjas (free tier)
            // This is optional - we fall back to cached data if it fails
            try {
                // Population.io API for world population
                const response = await fetch('https://d6wn6bmjj722w.population.io/1.0/population/World/today-and-tomorrow/');
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.total_population) {
                        // Could update CONFIG with live data here
                        status.population = 'live';
                        console.log('Live population data available:', data);
                    }
                }
            } catch (e) {
                console.log('Using cached population data (API unavailable)');
            }

            // Epoch AI data is available as CSV download, not live API
            // NVIDIA SEC filings require manual parsing
            // WSTS requires subscription
            // So chip data remains cached but well-sourced

            return status;
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        document.addEventListener('DOMContentLoaded', async () => {
            loadFromURL();
            createChart();
            setupControls();
            setupSuggestionForm();
            updateCounters();
            updateCrossover();

            // Try to fetch live data (non-blocking)
            fetchLiveData().then(status => {
                console.log('Data source status:', status);
            });

            // Update counters periodically
            // Update counters every 50ms for smooth animation
            setInterval(updateCounters, 50);
        });

        // ============================================
        // ANALYTICS TRACKING
        // ============================================

        const ANALYTICS_ENDPOINT = 'https://tnu93m4j91.execute-api.ca-central-1.amazonaws.com/analytics/event';

        // Generate or retrieve visitor ID
        function getVisitorId() {
            let visitorId = localStorage.getItem('foomist_visitor_id');
            if (!visitorId) {
                visitorId = 'v_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('foomist_visitor_id', visitorId);
            }
            return visitorId;
        }

        // Generate or retrieve session ID
        function getSessionId() {
            let sessionId = sessionStorage.getItem('foomist_session_id');
            if (!sessionId) {
                sessionId = 's_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                sessionStorage.setItem('foomist_session_id', sessionId);
            }
            return sessionId;
        }

        // Track an event
        function trackEvent(eventType, eventName, metadata = {}) {
            try {
                const data = {
                    visitorId: getVisitorId(),
                    sessionId: getSessionId(),
                    eventType: eventType,
                    eventName: eventName,
                    page: window.location.pathname,
                    referrer: document.referrer || '',
                    userAgent: navigator.userAgent,
                    screenSize: `${window.screen.width}x${window.screen.height}`,
                    metadata: metadata
                };

                // Use sendBeacon for reliability, fallback to fetch
                const payload = JSON.stringify(data);
                if (navigator.sendBeacon) {
                    navigator.sendBeacon(ANALYTICS_ENDPOINT, payload);
                } else {
                    fetch(ANALYTICS_ENDPOINT, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: payload,
                        keepalive: true
                    }).catch(() => {});
                }
            } catch (e) {
                // Silently fail - analytics should never break the site
            }
        }

        // Track page view on load
        window.addEventListener('load', () => {
            trackEvent('page_view', 'page_load', {
                url: window.location.href,
                title: document.title
            });
        });

        // Track brain estimate changes
        document.querySelectorAll('[data-brain]').forEach(btn => {
            btn.addEventListener('click', () => {
                trackEvent('interaction', 'brain_estimate_change', {
                    value: btn.dataset.brain
                });
            });
        });

        // Track birth scenario changes
        document.querySelectorAll('[data-birth]').forEach(btn => {
            btn.addEventListener('click', () => {
                trackEvent('interaction', 'birth_scenario_change', {
                    value: btn.dataset.birth
                });
            });
        });

        // Track Moore's Law slider changes (debounced)
        let mooreSliderTimeout = null;
        document.getElementById('moore-slider').addEventListener('change', (e) => {
            clearTimeout(mooreSliderTimeout);
            mooreSliderTimeout = setTimeout(() => {
                trackEvent('interaction', 'moore_slider_change', {
                    value: e.target.value + '%'
                });
            }, 500);
        });

        // Track reset button
        document.getElementById('moore-reset').addEventListener('click', () => {
            trackEvent('interaction', 'moore_reset_click');
        });

        // Track CTA button click
        document.querySelector('.cta-button').addEventListener('click', () => {
            trackEvent('interaction', 'cta_button_click');
        });

        // Copy link function
        function copyLink() {
            navigator.clipboard.writeText('https://foom.ist').then(() => {
                const copyText = document.getElementById('copy-text');
                copyText.textContent = 'Copied!';
                setTimeout(() => { copyText.textContent = 'Copy Link'; }, 2000);
                trackEvent('interaction', 'share_copy_link');
            });
        }
        window.copyLink = copyLink;

        // Track share button clicks
        document.querySelectorAll('.share-btn').forEach(btn => {
            if (!btn.classList.contains('copy')) {
                btn.addEventListener('click', () => {
                    const platform = btn.classList.contains('twitter') ? 'twitter' :
                                    btn.classList.contains('facebook') ? 'facebook' :
                                    btn.classList.contains('linkedin') ? 'linkedin' : 'unknown';
                    trackEvent('interaction', 'share_click', { platform });
                });
            }
        });

        // Track suggestion form submission
        document.getElementById('suggest-form').addEventListener('submit', () => {
            trackEvent('form', 'suggestion_submitted', {
                dataType: document.getElementById('data-type').value
            });
        });

        // Track scroll depth
        let maxScrollDepth = 0;
        window.addEventListener('scroll', () => {
            const scrollPercent = Math.round(
                (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100
            );
            if (scrollPercent > maxScrollDepth && scrollPercent % 25 === 0) {
                maxScrollDepth = scrollPercent;
                trackEvent('interaction', 'scroll_depth', {
                    depth: scrollPercent + '%'
                });
            }
        });

        // Track time on page (on unload)
        const pageLoadTime = Date.now();
        window.addEventListener('beforeunload', () => {
            const timeOnPage = Math.round((Date.now() - pageLoadTime) / 1000);
            trackEvent('interaction', 'page_exit', {
                timeOnPageSeconds: timeOnPage,
                maxScrollDepth: maxScrollDepth + '%'
            });
        });
    </script>
</body>
</html>
